process DigitizeAndAnalyze = {
    source = PoolSource {
	untracked vstring fileNames = {"file:sim.root"}
    }
    untracked PSet maxEvents = {untracked int32 input = -1}
    include "Configuration/StandardSequences/data/MixingNoPileUp.cff"
    
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    
    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cff"
    include "Geometry/DTGeometry/data/dtGeometry.cfi"
    
    include "SimMuon/DTDigitizer/data/muonDTDigis.cfi"
    #replace muonDTDigis.debug = true

    module out = PoolOutputModule {
	untracked string fileName ="digi.root"
    }
    
    module muondtdigianalyzer = DTDigiAnalyzer{
	untracked string label = "muonDTDigis"
    }	 

    include "Configuration/ReleaseValidation/data/Services.cff"
    include "HLTrigger/Configuration/data/rawToDigi/DTDigiToRaw.cff"

    module muonDTDigisPost = dtunpacker from "HLTrigger/Configuration/data/rawToDigi/dtUnpacker.cfi"
    replace muonDTDigisPost.fedColl = "rawDataCollector"
    sequence DTRawToDigi = { muonDTDigisPost }

    include "Configuration/StandardSequences/data/FakeConditions.cff"
    include "Configuration/StandardSequences/data/Reconstruction.cff"
    include "HLTrigger/Configuration/data/rawToDigi/DTDBCabling.cff"

    path p = {mix,muonDTDigis,muondtdigianalyzer,DTDigiToRaw,DTRawToDigi}
    endpath this_is_the_end = {out}
}

